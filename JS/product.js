// JavaScript Document for HTML "taoObject.html";
var arr = [{
    code: "GL123",
    name: "Mình yêu nhau nhé em!",
    price: 540.000,
    des: "Mình yêu nhau nhé em! gồm có hoa hồng đỏ và hoa lan trắng.",
    image: "Images/1.jpg"
}, {
    code: "GL103",
    name: "Vươn xa 2",
    price: 840.000,
    des: "Vươn Xa 2 gồm các loại hoa : - Hoa hồng môn - Hoa hồng dâu - Hoa mõm sói - Hoa lan mokara vàng - Hoa ly vàng",
    image: "Images/2.jpg"
}, {
    code: "GL341",
    name: "Sức khoẻ dồi dào",
    price: 960.000,
    des: "Sức khỏe dồi dào gồm : - Địa lan (hoa theo mùa) - Hướng dương - Ly hồng  - Thạch thảo tím - Lá và...",
    image: "Images/3.jpg"
}, {
    code: "GL003",
    name: "Nắng vàng tươi",
    price: 790.000,
    des: "Nắng vàng tươi gồm các loại hoa : - Lan mõm sói - 25 hoa hướng dương - 15 hoa hồng vàng - Lá v&ag...",
    image: "Images/4.jpg"
}, {
    code: "GL631",
    name: "Chúc thành công",
    price: 480.000,
    des: "Vchúc thành công được thiết kế với các loại hoa : - Hoa thiên điểu - Hoa hồng đỏ - Hoa ly vàng - Hồng môn",
    image: "Images/5.jpg"
}, {
    code: "GL133",
    name: "Khát khao",
    price: 350.000,
    des: "Khát Khao gồm có - Hoa mõm sói - Hoa lan vũ nữ - Hoa hồng đỏ và trắng - Hoa ly vàng",
    image: "Images/6.jpg"
}, {
    code: "GL148",
    name: "Trắng xanh",
    price: 420.000,
    des: "Trắng Xanh gồm các loại hoa : - Hoa cát tường trăng - Hoa mõm sói vàng",
    image: "Images/7.jpg"
}, {
    code: "GL103",
    name: "Ánh vàng",
    price: 600.000,
    des: "VÁnh Vàng gồm những loại hoa : - Greenvicky - Hoa hồng vàng - Hoa hồng pastel",
    image: "Images/8.jpg"
}, {
    code: "GL102",
    name: "Vươn xa 3",
    price: 840.000,
    des: "Vươn Xa 3 gồm các loại hoa : - Hoa hồng môn - Hoa hồng dâu - Hoa mõm sói - Hoa lan mokara vàng - Hoa ly vàng",
    image: "Images/9.jpg"
}, {
    code: "GL103",
    name: "I Love You",
    price: 650.000,
    des: "I Love You ! được thiết kế với hoa hồng đỏ và phụ liệu trang trí",
    image: "Images/10.jpg"
}, {
    code: "GL150",
    name: "Hoa chúc mừng 150",
    price: 420.000,
    des: "Hoa Chúc Mừng 150 gồm những loại hoa : - Lan mokara đỏ - Lan mokara vàng - Hoa hồng đỏ - Hoa ly vàng",
    image: "Images/11.jpg"
}, {
    code: "GL149",
    name: "Vũ điệu",
    price: 1 200.000,
    des: "Vũ điệu gồm các loại hoa : - Hoa hồng môn - Hoa hồng đỏ - Hoa hướng dương - Lan vũ nữ - Lan mokara vàng",
    image: "Images/12.jpg"
}, {
    code: "GL141",
    name: "Bé xinh",
    price: 420.000,
    des: "Bé Xinh gồm các loại hoa : - Hoa calimero - Hoa đồng tiền nhí - Hoa hồng trắng - Hoa hồng dâu",
    image: "Images/13.jpg"
}, {
    code: "GL053",
    name: "Yêu nhau dài lâu",
    price: 750.000,
    des: "Yêu Nhau Dài Lâu gồm các loại hoa : - Hoa cẩm tú cầu - Hoa greenvicky - Hoa hồng pastel - Hoa hồng son môi - Hoa hồng dâu",
    image: "Images/14.jpg"
}, {
    code: "GL113",
    name: "Strong And Success",
    price: 480.000,
    des: "Strong and success gồm các loại hoa : - Hoa hướng dương - Hoa hồng vàng - Môn xanh - Cẩm tú cầu",
    image: "Images/15.jpg"
}, {
    code: "GL019",
    name: "Hoa Vip 19",
    price: 960.000,
    des: "Hoa Vip 19 được thiết kế với các loại hoa : - Hoa hồng môn - Ly vàng - Lan vũ nữ - Lan mokara vàng",
    image: "Images/16.jpg"
}, {
    code: "GL072",
    name: "Hạ Vàng",
    price: 1 850.000,
    des: "Hạ Vàng được thiết kế với các loại hoa : - Lan hồ điệp - Lan vũ nữ - Lan mokara vàng - Lan mokara đỏ - Ly v&agra",
    image: "Images/17.jpg"
}, {
    code: "GL099",
    name: "Vững Chãi",
    price: 720.000,
    des: "Vững Chãi được thiết kế với các loại hoa : - Lan bò cạp đỏ - Cẩm tú cầu - Lan hồ điệp - Cúc calimero",
    image: "Images/18.jpg"
}, {
    code: "GL075",
    name: "Niềm Vui Lớn",
    price: 840.000,
    des: "Niềm vui mới được thiết kế từ các loại hoa : - Hoa hồng đỏ - Lan mokara vàng - Lan bò cạp đỏ - Ly vàng",
    image: "Images/19.jpg"
}, {
    code: "GL064",
    name: "Cám ơn",
    price: 400.000,
    des: "Cám Ơn được thiết kế với các loại hoa : - Lan mokara đỏ - Lan mokara vàng - Ly vàng - Hoa hồng phấn - L&a",
    image: "Images/20.jpg"
}, {
    code: "GL061",
    name: "Kiêu hãnh",
    price: 660.000,
    des: "Kiêu Hãnh được thiết kế với các loại hoa : - Ly vàng - Hoa hướng dương - Cẩm tú cầu - Lan bò cạp đỏ",
    image: "Images/21.jpg"
}, {
    code: "GL503",
    name: "Niềm Tin",
    price: 600.000,
    des: "Niềm tin được thiết kế với các loại hoa : - Lan mokara tím - Lan thái trắng - Chuỗi ngọc - Hoa hồng phấn",
    image: "Images/22.jpg"
}, {
    code: "GL101",
    name: "Hoa Tươi Đẹp",
    price: 1 200.000,
    des: "Hoa Giỏ 101 được thiết kế với các loại hoa : - Ly vàng - Hoa hồng trắng - Hoa hồng phấn - Lan thái trắng",
    image: "Images/23.jpg"
}];
// tìm sản phẩm khi biết tên ảnh
function findProduct(imgName) {
    for (var i = 0; i < arr.length; i++) {
        if (arr[i].image == imgName)
            return i;
    }
    return -1;
}
// tìm sản phẩm khi biết mã sản phẩm
function findProductByCode(code) {
    for (var i = 0; i < arr.length; i++) {
        if (arr[i].code == code)
            return i;
    }
    return -1;
}


function show() {
    // lấy Object có event
    var obj = window.event.target;
    // alert(obj);
    var imgName = obj.src;
    imgName = imgName.substring(imgName.lastIndexOf("/") + 1);
    // alert(imgName);

    var result = findProduct("Images/" + imgName); // tìm vị trí tìm thấy đường dẫn của image
    // alert(result);
    if (result >= 0) { // tìm thấy được thông tin
        var image = document.getElementById('image');
        image.src = arr[result].image;
        image.setAttribute("alt", arr[result].code);

        var div = document.getElementById('infor');
        div.innerHTML = "Code: " + arr[result].code;
        div.innerHTML += "<br>Name: " + arr[result].name;
        div.innerHTML += "<br>Price: " + arr[result].price;
        div.innerHTML += "<br>Description: " + arr[result].des;

        var div_details = document.getElementById('details');
        div_details.style.display = "block";
    }
}

function closeDetail() {
    var div_details = document.getElementById("details");
    div_details.style.display = "none";
}

function displayProducts() {

    var super_div = document.getElementById('list_products');

    for (var i = 0; i < arr.length; i++) {

        var sub_div = document.createElement('div');
        // sub_div.addEventListener();
        var images = document.createElement('img');
        images.src = arr[i].image;
        images.addEventListener('click', show); // gắn hàm show vào sư kiện onclick của ảnh

        var p1 = document.createElement('p');
        p1.innerHTML = arr[i].name;

        var p2 = document.createElement('p');
        p2.innerHTML = arr[i].price;

        sub_div.appendChild(images);
        sub_div.appendChild(p1);
        sub_div.appendChild(p2);
        super_div.appendChild(sub_div);
    };
}

// ham khoi tao bien count = 0 trong localstorage
function init() {
    if (window.localStorage.getItem("count") == null)
        window.localStorage.setItem("count", 0);
}

function addProduct(id_hinh, id_select) {
    // nối lại và gọi là key, mang key dùng getItem để lấy value
    var the_img = document.getElementById(id_hinh);
    var masp = the_img.alt;
    var the_select = document.getElementById(id_select);
    var i = the_select.selectedIndex;
    var kc = the_select.options[i].text;

    var key = masp + ", " + kc;
    var result = window.localStorage.getItem(key); // luon tra ve String

    if (result == null) { // masp khong co trong local
        window.localStorage.setItem(key, "1"); // mặc định giá trị là 1
        var c = window.localStorage.getItem("count");
        c = parseInt(c) + 1;
        window.localStorage.setItem("Count", c);
        window.alert("Đã thêm vào đơn hàng của bạn!");
    } else {
        result = parseInt(result) + 1;
        window.localStorage.setItem(key, result); // vào key cập nhật result 
    }
}

function showDetail() {
    // lấy thông tin đồng hồ máy tính của client
    var d = new Date();
    var ngay = d.getDate();
    var thang = d.getMonth() + 1;
    var nam = d.getFullYear();
    var p_ngaydat = document.getElementById("ngaydat");
    p_ngaydat.innerHTML += ngay + "/" + thang + "/" + nam;

    // tao số đơn đặth hàng ngaoax nhiên
    var x = Math.round(Math.random() * 89999 + 10000)
    var p_soddh = document.getElementById("soDDH");
    p_soddh.innerHTML += x;

    // code này để lấy dât trong localStorage đặt vào điv id="chitiet"
    var tmp = "<table><caption>Chi tiết đặt hàng</caption>";
    tmp = tmp + "<tr>";
    tmp = tmp + "<th>Mã sản phẩm</th>";
    tmp = tmp + "<th>Sản phẩm</th>";
    tmp = tmp + "<th>Giá sản phẩm</th>";
    tmp = tmp + "<th>Số lượng</th>";
    tmp = tmp + "<th>Hình ảnh</th>";
    tmp = tmp + "<th>Tổng giá</th>";
    tmp = tmp + "<th>Xoá</th>";
    tmp = tmp + "</tr>";

    // chèn thêm tr dựa vào count
    var c = window.localStorage.getItem("count");
    if (c != null) {
        for (var i = 0; i < window.localStorage.length; i++) {
            var key = window.localStorage.key(i);
            if (key.match("^[A-Z]{2}[0-9]{3}[,]") != null) {
                var kq = findProductByCode(brr[0]);
                var sl = window.localStorage.getItem(key);
                if (kq >= 0 && sl != null) {
                    tmp = tmp + "<tr>";
                    tmp = tmp + "<td>" + arr[kq].code + "</td>";
                    tmp = tmp + "<td>" + arr[kq].name + "</td>";
                    tmp = tmp + "<td>" + arr[kq].price + "</td>";
                    tmp = tmp + "<td><input type='number' value='" + sl + "'min=1' max='10'</td>";
                    tmp = tmp + "<td>" + (arr[kq].image) * sl + "</td>";
                    tmp = tmp + "</tr>";
                }
            }
        }
    }

    tmp = tmp + "</table>";
    var div = document.getElementById("chitiet");
    div.innerHTML = tmp;

}

function validate() {
    var t1 = document.getElementById("t1");
    var t2 = document.getElementById("t2");
    var t3 = document.getElementById("t3");
    if (t1.value == "") {
        alert("Your name is invalid!");
        t1.focus();
        return false;
    } else
    if (t2.value == "") {
        alert("Your address is invalid!");
        t2.focus();
        return false;
    } else
    if (t3.value == "" || t3.value.match("^[0-9]{10,11}$") == null) {
        alert("Your phone is invalid!");
        t3.focus();
        return false;
    }
    alert("Cảm ơn bạn đã đặt hàng cho chúng tôi. Đơn hàng của bạn đang được xử lí");
    window.open("indexsanpham.html", "_self");
    return true;
}